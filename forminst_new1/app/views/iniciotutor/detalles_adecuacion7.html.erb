
<div class="modal fade" id="myModal" role="dialog">
  <div class="modal-dialog">
    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Mensaje de confirmación</h4>
      </div>
      <div class="modal-body">
      <center>
        <h5>¿Está seguro que desea enviar esta adecuación?</h5>
      </center>
      </div>
      <div class="modal-footer">
        <%= link_to "Aceptar", {controller: "iniciotutor", action: "cambiar_estatusA", :adecuacion_id => @adecuacion.id }, class: "btn btn-default" %>
      
        <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
      </div>
    </div>
    
  </div>
</div>

<div class="modal fade" id="myModalEliminar" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h3 class="modal-title" id="myModalLabel">Eliminar Adecuación</h3>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <center>
            <h5>¿Está seguro que desea eliminar esta adecuación?</h5>
          </center>
        </div>
      </div>
      <div class="modal-footer">
        <%= link_to "Aceptar", {controller: "iniciotutor", action: "eliminar_adecuacion" }, class: "btn btn-default" %>
          <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="myModal2" role="dialog">
  <div class="modal-dialog">
    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Mensaje de notificación</h4>
      </div>
      <div class="modal-body">
        <h5>La adecuación ya fue enviada.</h5>
      </div>
      <div class="modal-footer">
    
        <button type="button" class="btn btn-default" data-dismiss="modal">Aceptar</button>
      </div>
    </div>
    
  </div>
</div>


<div class="modal fade" id="myModal3" role="dialog">
  <div class="modal-dialog">
    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Mensaje de notificación</h4>
      </div>
      <div class="modal-body">
        <h5>No puede realizar ningún cambio debido a que la adecuación ya fue enviada.</h5>
      </div>
      <div class="modal-footer">
    
        <button type="button" class="btn btn-default" data-dismiss="modal">Aceptar</button>
      </div>
    </div>
    
  </div>
</div>



<div class = 'row'>
  <div class="col-xs-12 col-md-12">
      <ul class="nav nav-tabs">
        <li><a href="../iniciotutor/index">Inicio</a></li>
        <li><a href="../iniciotutor/planformacions" class='active'>Plan de Formación</a></li>
        <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Informes <span class="caret"></span></a>
            <ul class="dropdown-menu nav" role="menu">
              <li></li>
                                                        
              <%if @cpBloquear%>
                <li><a href="#" style="color:gray">Crear Informe</a></li>
              <%else%>
              <li><a href="#" data-toggle="modal" data-target="#selectInforme">
                Crear Informe
              </a></li>
              <%end%>

              <li><%= link_to 'Listar Informes', :controller => 'informes', :action => 'listar_informes' %></li>
            </ul>
        </li>
        <li><%= link_to 'Prórroga', :controller => 'iniciotutor', :action => 'prorroga' %></li>
        <li><a href="../iniciotutor/logout">Cerrar Sesión</a></li>
      </ul>
  </div>
</div>

<div class="modal fade" id="selectInforme" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h3 class="modal-title" id="myModalLabel">Eliminar Informe</h3>
      </div>
      <div class="modal-body">
        <h5>Seleccione el informe a crear</h5>
      </div>
      <div class="modal-body">
        <b>&emsp;&emsp;&emsp;</b>
        <%= link_to "Informe 1", {controller: "informes", action: "ver_crear_informe", :informe_id => 1 }, class: "btn btn-forminst-blue" %>
        <b>&emsp;&emsp;&emsp;</b>
        <%= link_to "Informe 2", {controller: "informes", action: "ver_crear_informe", :informe_id => 2 }, class: "btn btn-forminst-blue" %>
        <b>&emsp;&emsp;&emsp;</b>
        <%= link_to "Informe 3", {controller: "informes", action: "ver_crear_informe", :informe_id => 3 }, class: "btn btn-forminst-blue" %>
        <b>&emsp;&emsp;&emsp;</b>
        <%= link_to "Informe 4", {controller: "informes", action: "ver_crear_informe", :informe_id => 4 }, class: "btn btn-forminst-blue" %>
        <p>   </p>
        <b>&emsp;&emsp;&emsp;</b>
        <%= link_to "Informe 5", {controller: "informes", action: "ver_crear_informe", :informe_id => 5 }, class: "btn btn-forminst-blue" %>
        <b>&emsp;&emsp;&emsp;</b>
        <%= link_to "Informe 6", {controller: "informes", action: "ver_crear_informe", :informe_id => 6 }, class: "btn btn-forminst-blue" %>
        <b>&emsp;&emsp;&emsp;</b>
        <%= link_to "Informe 7", {controller: "informes", action: "ver_crear_informe", :informe_id => 7 }, class: "btn btn-forminst-blue" %>
        <b>&emsp;&emsp;&emsp;</b>
        <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
      </div>
    </div>
  </div>
</div>


<div class="row">
  <div class="col-xs-12 col-md-12">
      <%if !session[:editar]%> 
        <%= form_tag({controller: 'iniciotutor', action: 'detalles_adecuacion3',:class => "form-inline"}) do%>
          <input type="hidden" name="plan_id" value=<%= session[:plan_id] %>>
          <input type="hidden" name="editar" value='si'>
          <div class="btn-group" role="group">
            <button type="button" class="btn btn-default" onclick = " location.href = 'javascript:history.back(-1);'">Volver</button>
            <button type="button" data-toggle="modal" data-target="#myModal" class="btn btn-default">Enviar</button>
            <%= link_to "Vista Previa", {controller: "iniciotutor", action: "vista_previa"}, class: "btn btn-default" %>
            <%= link_to "Generar PDF", {controller: "adecuacions", action: "generar_pdf"},target: :_blank, class: "btn btn-default" %>
            <%= link_to "Agregar Soporte", {controller: "documents", action: "new"}, class: "btn btn-default" %>
            <%= link_to "Ver Soporte", {controller: "documents", action: "index"}, class: "btn btn-default" %>
            <%= link_to "Versiones Anteriores", {controller: "iniciotutor", action: "ver_respaldos"}, class: "btn btn-default" %>
            <button type="button" class="btn btn-danger" data-toggle="modal" data-target="#myModalEliminar">Eliminar Adecuación</button>
            <% if @bool_enviado == 0%>
              <button type="submit" class="btn btn-forminst-blue">Modificar Adecuación</button>
            <% else%>
              <button type="submit" class="btn btn-forminst-blue" disabled>Modificar Adecuación</button>
            <% end%>
          </div>
        <%end%>
      <%else%>
        <div class="btn-group" role="group">
          <button type="button" class="btn btn-default" onclick = " location.href = 'javascript:history.back(-1);'">Volver</button>
          <button type="button" data-toggle="modal" data-target="#myModal" class="btn btn-default">Enviar</button>
          <%= link_to "Vista Previa", {controller: "iniciotutor", action: "vista_previa"}, class: "btn btn-default" %>
          <%= link_to "Generar PDF", {controller: "adecuacions", action: "generar_pdf"},target: :_blank, class: "btn btn-default" %>
          <%= link_to "Agregar Soporte", {controller: "documents", action: "new"}, class: "btn btn-default" %>
          <%= link_to "Ver Soporte", {controller: "documents", action: "index"}, class: "btn btn-default" %>
          <%= link_to "Versiones Anteriores", {controller: "iniciotutor", action: "ver_respaldos"}, class: "btn btn-default" %>
          <button type="button" class="btn btn-danger" data-toggle="modal" data-target="#myModalEliminar">Eliminar Adecuación</button>
        </div>
      <%end%>
  </div>
</div>

<div class="row">
  <div class="col-xs-12 col-md-12 col-md-offset-0">
      <div class= "text-left">
      <%if @nombre%>
        <div>
          <span><%= link_to 'Plan Formación', :controller => 'iniciotutor', :action => 'planformacions' %></span>
          <p style="display:inline"> / </p>
          <%if !session[:editar]%> 
            <span><%= link_to session[:instructorName] , :controller => 'iniciotutor', :action => 'ver_detalles_adecuacion' %></span>
            <p style="display:inline"> /  Detalles Actividades para la Aprobación  </p>
          <%else %>
            <span><%= link_to session[:instructorName] , :controller => 'iniciotutor', :action => 'ver_detalles_adecuacion' %></span>
            <p style="display:inline"> / Modificar Actividades para la Aprobación </p>
          <%end%>   
        </div>
      <%end%>
    </div>
    <div class="text-right">
      <div id = "fechamuestra">
        <h3> <%= Time.now.strftime("%d") %>
          <% if Time.now.strftime("%m").to_i == 1 %>
            de Enero del
          <% elsif Time.now.strftime("%m").to_i == 2 %>
            de Febrero del
          <% elsif Time.now.strftime("%m").to_i == 3 %>
            de Marzo del
          <% elsif Time.now.strftime("%m").to_i == 4 %>
            de Abril del
          <% elsif Time.now.strftime("%m").to_i == 5 %>
            de Mayo del
          <% elsif Time.now.strftime("%m").to_i == 6 %>
            de Junio del
          <% elsif Time.now.strftime("%m").to_i == 7 %>
            de Julio del
          <% elsif Time.now.strftime("%m").to_i == 8 %>
            de Agosto del
          <% elsif Time.now.strftime("%m").to_i == 9 %>
            de Septiembre del
          <% elsif Time.now.strftime("%m").to_i == 10 %>
            de Octubre del
          <% elsif Time.now.strftime("%m").to_i == 11 %>
            de Noviembre del
          <% elsif Time.now.strftime("%m").to_i == 12 %>
            de Diciembre del
          <% end %>
          <%= Time.now.strftime("%Y") %> 
        </h3>
      </div>
      <%if @nombre%>
        <div>
          <h4><b><%=@nombre%></b></h4>
        </div>
      <%end%>
    </div>
  </div>
</div>

<div class = 'row'>
  <div class="col-xs-11 col-xs-offset-1 col-md-12 col-md-offset-0 text-justify">
    <h1 class="text-left">Detalles de la Adecuación</h1>
    <h4><b> Instructor :  <%=session[:instructorName]%></b></h4>
  </div>
</div>
<br>
<div class = 'row'>
  <div class = 'col-xs-12 col-md-12 col-lg-12'>
      <ul class="tabs">
        <li><%= link_to '1° Semestre', :controller => 'iniciotutor', :action => 'detalles_adecuacion3' %></li>
        <li><%= link_to '2° Semestre', :controller => 'iniciotutor', :action => 'detalles_adecuacion4' %></li>
        <li><%= link_to '3° Semestre', :controller => 'iniciotutor', :action => 'detalles_adecuacion5' %></li>
        <li><%= link_to '4° Semestre', :controller => 'iniciotutor', :action => 'detalles_adecuacion6' %></li>
        <li class="activa"><a href="#">Obligatorias</a></li>
      </ul>
  </div>
</div>
<div class= "row">
  <div class="col-xs-12 col-md-12 col-lg-12">
    <%= form_tag({controller: 'iniciotutor', action: 'ver_detalles_adecuacion'}) do%>
        <input id="cant_delete" type="hidden" name="cant_delete" value="0"/>
        <input id="cant_edit" type="hidden" name="cant_edit" value="0"/> 
        <input id="cant_docencia" type="hidden" name="cant_docencia" value="0"/> 
        <input id="cant_obligatoria" type="hidden" name="cant_obligatoria" value="0"/> 
        <input id="cant_investigacion" type="hidden" name="cant_investigacion" value="0"/> 
        <input id="cant_formacion" type="hidden" name="cant_formacion" value="0"/> 
        <input id="cant_extension" type="hidden" name="cant_extension" value="0"/> 
        <input id="cant_otra" type="hidden" name="cant_otra" value="0"/> 
        <input id="semestre" type="hidden" name="semestre" value="5"/> 
        <table class="table table-bordered table-striped">
          <tbody>
            <tr></tr>
            <tr>
              <td class="text-left" colspan="3"><h5><strong>4. Actividades a realizar por el instructor</strong></h5></td>
              
            </tr>
            <tr>
              <td class="text-center" colspan="2"><strong>Actividades para la Aprobación</strong></td>
              <%if session[:editar]%> 
                <td class="text-center"  style='width:10%;'><strong>Observaciones</strong></td>
              <%else%>
                <td class="text-center"  style='width:15%;'><strong>Observaciones</strong></td>
              <%end%>              
            </tr>
              <% @actividadesaobli.each_with_index do |actdoc, i| %>
                <tr>
                  <td style='width:80%;'>
                    <textarea class="form-control" rows="2"  name='<%= @obligatoria+actdoc.id.to_s %>' id ='<%= actdoc.id %>' disabled><%= actdoc.actividad %></textarea>
                    <input type="hidden" name="<%= @iddoc+i.to_s%> " value='<%= actdoc.id %>'>
                  </td>
                  <%if session[:editar]%> 
                    <td>
                      <center>
                        <a id = 'button<%= actdoc.id %>' rel='<%= actdoc.id %> <%= actdoc.actividad %>' class="edit_act btn btn-default btn-lg" aria-label="Editar">
                          <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                        </a>
                         <a id = 'delete<%= actdoc.id %>' rel='<%= actdoc.id %>' class="delete_act btn btn-default btn-lg" aria-label="Eliminar"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span></a>
                      </center>
                    </td>
                  <%else%>
                    <td></td>
                  <%end%>
                  <td >
                  <center>
                    <%= link_to "Ver observaciones ", {:controller => "iniciotutor", :action => "mas_observaciones3", :actividad_id => actdoc.id, :semestre => 4, :adecuacion_id => @adecuacion.id }, class: "pad add btn btn-default" %>
                    </center>
                  </td>
                </tr>
              <% end %>
          <tr id="lastactdoc">
            <%if session[:editar]%> 
              <td  colspan="3"><a class="agregar_docencia add btn btn-default"><span class="glyphicon glyphicon-plus"></span> Agregar otra actividad para la Aprobación</a>
              </td>
            <%end%>
          </tr>
          </tbody> 
        </table>
      <%if session[:editar]%> 
        <div class = 'row'>
          <%if @bool_enviado == 0 %>
             <center><button type="submit" class="btn btn-forminst btn-lg">Guardar</button></center>
          <%else%>
            <center> <button type="button" data-toggle="modal" data-target="#myModal3" class="btn btn-forminst btn-lg" >Guardar</button></center>
          <%end%> 
        </div>
      <%end%> 
    <% end %>
  </div>
</div>

<div class = 'row'>
  <div class = 'col-xs-3 col-md-3 col-lg-3'>
      <button type="button" class="btn btn-forminst" onclick = " location.href = 'javascript:history.back(-1);'">&lt;&lt; Volver</button>
  </div>
</div>

<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h3 class="modal-title" id="myModalLabel">Eliminar Adecuación</h3>
      </div>
      <div class="modal-body">
          <%= form_tag({controller: 'iniciotutor', action: 'eliminar_adecuacion'}) do%>
            <div class="form-group">
              <center>
                <h5><strong>Está seguro que desea eliminar esta adecuación?</strong></h5>
              </center>
            </div>
      </div>
      <div class="modal-footer">
          <button type="submit" class="btn btn-forminst">Si</button>
          <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
      </div>
      <%end%>
    </div>
  </div>
</div>

<script type="text/javascript">
  function eliminar (elemento){
    $(elemento).parent().parent().parent().remove();
  }
</script>

<script type="text/javascript">

    $(document).ready(function() {
      var cant_delete=0;
      var cant_edit=0;
      var cant_docencia=0;
      var cant_obligatoria=0;
      var cant_investigacion=0;
      var cant_formacion=0;
      var cant_extension=0;
      var cant_otra=0;

      $(".delete_act").click(function() {
        var id_act = $(this).attr("rel");
        $(this).parent().parent().append("<input type='hidden' name='delete"+cant_delete+"' value='"+id_act+"'>")
        $(this).parent().parent().parent().hide();
        cant_delete +=1;
        $("#cant_delete").val(cant_delete);
      });

      $(".edit_act").click(function() {
        var params = $(this).attr("rel");
        var arr= params.split(' ');
        var id = arr[0];
        var text_act = arr[1];
        $("#"+id).prop( "disabled", false );
        $("#button"+id).prop( "disabled", true );
        $(this).parent().parent().append("<input type='hidden' name='edit"+cant_edit+"' value='"+id+"'>")
        cant_edit +=1;
        $("#cant_edit").val(cant_edit);
      });


      $(".agregar_docencia").click(function() {
        $("#lastactdoc").before('<tr>\
                                <td>\
                                  <textarea class="form-control" rows="2"  name="nuevaobli'+cant_obligatoria+'" required></textarea>\
                                </td>\
                                <td>\
                                  <center>\
                                    <button type="button" class="btn btn-default btn-lg" title="Eliminar" onclick = "eliminar(this)">\
                                      <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>\
                                    </button>\
                                  </center>\
                                </td>\
                                <td>\
                                </td>\
                              </tr>');
          cant_obligatoria = cant_obligatoria + 1;
          console.log(cant_obligatoria);
          $("#cant_obligatoria").val(cant_obligatoria);
          
      });

    });
</script>